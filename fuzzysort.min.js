!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).fuzzysort={})}(this,(function(e){"use strict";const r=(e,r)=>{if(!e||!r)return z;var t=_(e);I(r)||(r=g(r));var n=t.bitflags;return(n&r._bitflags)!==n?z:d(t,r)},t=(e,r,t)=>{if(!e)return t?.all?u(r,t):T;var n=_(e),s=n.bitflags,o=n.containsSpace,a=l(t?.threshold||0),f=t?.limit||A,c=0,v=0,h=r.length;function p(e){c<f?(O.add(e),++c):(++v,e._score>O.peek()._score&&O.replaceTop(e))}if(t?.key)for(var x=t.key,b=0;b<h;++b){var w=r[b];if(G=B(w,x))if(I(G)||(G=g(G)),(s&G._bitflags)===s)(H=d(n,G))!==z&&(H._score<a||(H.obj=w,p(H)))}else if(t?.keys){var y=t.keys,k=y.length;e:for(b=0;b<h;++b){w=r[b];for(var C=0,D=0;D<k;++D){x=y[D];(G=B(w,x))?(I(G)||(G=g(G)),j[D]=G,C|=G._bitflags):j[D]=F}if((s&C)===s){if(o)for(let e=0;e<n.spaceSearches.length;e++)S[e]=M;for(D=0;D<k;++D)if((G=j[D])!==F)if(m[D]=d(n,G,!1,o),m[D]!==z){if(o)for(let e=0;e<n.spaceSearches.length;e++){if(L[e]>-1e3)if(S[e]>M)(q=(S[e]+L[e])/4)>S[e]&&(S[e]=q);L[e]>S[e]&&(S[e]=L[e])}}else m[D]=F;else m[D]=F;if(o){for(let e=0;e<n.spaceSearches.length;e++)if(S[e]===M)continue e}else{var E=!1;for(let e=0;e<k;e++)if(m[e]._score!==M){E=!0;break}if(!E)continue}var N=new i(k);for(let e=0;e<k;e++)N[e]=m[e];if(o){var P=0;for(let e=0;e<n.spaceSearches.length;e++)P+=S[e]}else{P=M;for(let e=0;e<k;e++){var q;if((H=N[e])._score>-1e3)if(P>M)(q=(P+H._score)/4)>P&&(P=q);H._score>P&&(P=H._score)}}if(N.obj=w,N._score=P,t?.scoreFn){if(!(P=t.scoreFn(N)))continue;P=l(P),N._score=P}P<a||p(N)}}}else for(b=0;b<h;++b){var G,H;if(G=r[b])if(I(G)||(G=g(G)),(s&G._bitflags)===s)(H=d(n,G))!==z&&(H._score<a||p(H))}if(0===c)return T;var J=new Array(c);for(b=c-1;b>=0;--b)J[b]=O.poll();return J.total=c+v,J},n=e=>{"number"==typeof e?e=""+e:"string"!=typeof e&&(e="");var r=p(e);return a(e,{_targetLower:r._lower,_targetLowerCodes:r.lowerCodes,_bitflags:r.bitflags})},s=()=>{b.clear(),w.clear()};class o{get indexes(){return this._indexes.slice(0,this._indexes.len).sort(((e,r)=>e-r))}set indexes(e){return this._indexes=e}highlight(e,r){return((e,r="<b>",t="</b>")=>{for(var n="function"==typeof r?r:void 0,s=e.target,o=s.length,i=e.indexes,a="",f=0,l=0,c=!1,g=[],_=0;_<o;++_){var u=s[_];if(i[l]===_){if(++l,c||(c=!0,n?(g.push(a),a=""):a+=r),l===i.length){n?(a+=u,g.push(n(a,f++)),a="",g.push(s.substr(_+1))):a+=u+t+s.substr(_+1);break}}else c&&(c=!1,n?(g.push(n(a,f++)),a=""):a+=t);a+=u}return n?g:a})(this,e,r)}get score(){return f(this._score)}set score(e){this._score=l(e)}}class i extends Array{get score(){return f(this._score)}set score(e){this._score=l(e)}}const a=(e,r)=>{const t=new o;return t.target=e,t.obj=r.obj??z,t._score=r._score??M,t._indexes=r._indexes??[],t._targetLower=r._targetLower??"",t._targetLowerCodes=r._targetLowerCodes??z,t._nextBeginningIndexes=r._nextBeginningIndexes??z,t._bitflags=r._bitflags??0,t},f=e=>e===M?0:e>1?e:Math.E**(-2*((1-e)**.04307-1)),l=e=>0===e?M:e>1?e:1-Math.pow(Math.log(e)/-2+1,1/.04307),c=e=>{"number"==typeof e?e=""+e:"string"!=typeof e&&(e=""),e=e.trim();var r=p(e),t=[];if(r.containsSpace){var n=e.split(/\s+/);n=[...new Set(n)];for(var s=0;s<n.length;s++)if(""!==n[s]){var o=p(n[s]);t.push({lowerCodes:o.lowerCodes,_lower:n[s].toLowerCase(),containsSpace:!1})}}return{lowerCodes:r.lowerCodes,_lower:r._lower,containsSpace:r.containsSpace,bitflags:r.bitflags,spaceSearches:t}},g=e=>{if(e.length>999)return n(e);var r=b.get(e);return void 0!==r||(r=n(e),b.set(e,r)),r},_=e=>{if(e.length>999)return c(e);var r=w.get(e);return void 0!==r||(r=c(e),w.set(e,r)),r},u=(e,r)=>{var t=[];t.total=e.length;var n=r?.limit||A;if(r?.key)for(var s=0;s<e.length;s++){var o=e[s];if((_=B(o,r.key))!=z){I(_)||(_=g(_));var f=a(_.target,{_score:_._score,obj:o});if(t.push(f),t.length>=n)return t}}else if(r?.keys)for(s=0;s<e.length;s++){o=e[s];for(var l=new i(r.keys.length),c=r.keys.length-1;c>=0;--c){(_=B(o,r.keys[c]))?(I(_)||(_=g(_)),_._score=M,_._indexes.len=0,l[c]=_):l[c]=F}if(l.obj=o,l._score=M,t.push(l),t.length>=n)return t}else for(s=0;s<e.length;s++){var _;if((_=e[s])!=z&&(I(_)||(_=g(_)),_._score=M,_._indexes.len=0,t.push(_),t.length>=n))return t}return t},d=(e,r,t=!1,n=!1)=>{if(!1===t&&e.containsSpace)return v(e,r,n);for(var s=e._lower,i=e.lowerCodes,a=i[0],f=r._targetLowerCodes,l=i.length,c=f.length,g=0,_=0,u=0;;){if(a===f[_]){if(y[u++]=_,++g===l)break;a=i[g]}if(++_>=c)return z}g=0;var d=!1,h=0,p=r._nextBeginningIndexes;p===z&&(p=r._nextBeginningIndexes=x(r.target));var b=0;if((_=0===y[0]?0:p[y[0]-1])!==c)for(;;)if(_>=c){if(g<=0)break;if(++b>200)break;--g;var w=k[--h];_=p[w]}else{if(i[g]===f[_]){if(k[h++]=_,++g===l){d=!0;break}++_}else _=p[_]}var C=l<=1?-1:r._targetLower.indexOf(s,y[0]),S=!!~C,L=!!S&&(0===C||r._nextBeginningIndexes[C-1]===C);if(S&&!L)for(var j=0;j<p.length;j=p[j])if(!(j<=C)){for(var m=0;m<l&&i[m]===r._targetLowerCodes[j+m];m++);if(m===l){C=j,L=!0;break}}var B=e=>{for(var r=0,t=0,n=1;n<l;++n)e[n]-e[n-1]!=1&&(r-=e[n],++t);if(r-=(12+(e[l-1]-e[0]-(l-1)))*t,0!==e[0]&&(r-=e[0]*e[0]*.2),d){var s=1;for(n=p[0];n<c;n=p[n])++s;s>24&&(r*=10*(s-24))}else r*=1e3;return r-=(c-l)/2,S&&(r/=1+l*l*1),L&&(r/=1+l*l*1),r-=(c-l)/2};if(d)if(L){for(j=0;j<l;++j)y[j]=C+j;I=y,A=B(y)}else I=k,A=B(k);else{if(S)for(var j=0;j<l;++j)y[j]=C+j;var I,A=B(I=y)}r._score=A;for(j=0;j<l;++j)r._indexes[j]=I[j];r._indexes.len=l;const M=new o;return M.target=r.target,M._score=r._score,M._indexes=r._indexes,M},v=(e,r,t)=>{for(var n=new Set,s=0,o=z,i=0,a=e.spaceSearches,f=a.length,l=0,c=()=>{for(let e=l-1;e>=0;e--)r._nextBeginningIndexes[C[2*e+0]]=C[2*e+1]},g=!1,_=0;_<f;++_){L[_]=M;var u=a[_];if(o=d(u,r),t){if(o===z)continue;g=!0}else if(o===z)return c(),z;if(!(_===f-1)){var v=o._indexes,h=!0;for(let e=0;e<v.len-1;e++)if(v[e+1]-v[e]!=1){h=!1;break}if(h){var p=v[v.len-1]+1,x=r._nextBeginningIndexes[p-1];for(let e=p-1;e>=0&&x===r._nextBeginningIndexes[e];e--)r._nextBeginningIndexes[e]=p,C[2*l+0]=e,C[2*l+1]=x,l++}}s+=o._score/f,L[_]=o._score/f,o._indexes[0]<i&&(s-=2*(i-o._indexes[0])),i=o._indexes[0];for(var b=0;b<o._indexes.len;++b)n.add(o._indexes[b])}if(t&&!g)return z;c();var w=d(e,r,!0);if(w!==z&&w._score>s){if(t)for(_=0;_<f;++_)L[_]=w._score/f;return w}t&&(o=r),o._score=s;_=0;for(let e of n)o._indexes[_++]=e;return o._indexes.len=_,o},h=e=>e.replace(/\p{Script=Latin}+/gu,(e=>e.normalize("NFD"))).replace(/[\u0300-\u036f]/g,""),p=e=>{for(var r=(e=h(e)).length,t=e.toLowerCase(),n=[],s=0,o=!1,i=0;i<r;++i){var a=n[i]=t.charCodeAt(i);if(32!==a)s|=1<<(a>=97&&a<=122?a-97:a>=48&&a<=57?26:a<=127?30:31);else o=!0}return{lowerCodes:n,bitflags:s,containsSpace:o,_lower:t}},x=e=>{for(var r=(e=h(e)).length,t=(e=>{for(var r=e.length,t=[],n=0,s=!1,o=!1,i=0;i<r;++i){var a=e.charCodeAt(i),f=a>=65&&a<=90,l=f||a>=97&&a<=122||a>=48&&a<=57,c=f&&!s||!o||!l;s=f,o=l,c&&(t[n++]=i)}return t})(e),n=[],s=t[0],o=0,i=0;i<r;++i)s>i?n[i]=s:(s=t[++o],n[i]=void 0===s?r:s);return n},b=new Map,w=new Map;var y=[],k=[],C=[],S=[],L=[],j=[],m=[];const B=(e,r)=>{var t=e[r];if(void 0!==t)return t;if("function"==typeof r)return r(e);var n=r;Array.isArray(r)||(n=r.split("."));for(var s=n.length,o=-1;e&&++o<s;)e=e[n[o]];return e},I=e=>"object"==typeof e&&"number"==typeof e._bitflags,A=1/0,M=-A,T=[];T.total=0;const z=null,F=n(""),O=(D=[],E=0,P=e=>{for(var r=0,t=D[r],n=1;n<E;){var s=n+1;r=n,s<E&&D[s]._score<D[n]._score&&(r=s),D[r-1>>1]=D[r],n=1+(r<<1)}for(var o=r-1>>1;r>0&&t._score<D[o]._score;o=(r=o)-1>>1)D[r]=D[o];D[r]=t},(N={}).add=e=>{var r=E;D[E++]=e;for(var t=r-1>>1;r>0&&e._score<D[t]._score;t=(r=t)-1>>1)D[r]=D[t];D[r]=e},N.poll=e=>{if(0!==E){var r=D[0];return D[0]=D[--E],P(),r}},N.peek=e=>{if(0!==E)return D[0]},N.replaceTop=e=>{D[0]=e,P()},N);var D,E,N,P,q={single:r,go:t,prepare:n,cleanup:s};e.cleanup=s,e.default=q,e.go=t,e.prepare=n,e.single=r,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=fuzzysort.min.js.map
